
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EDA: NeurIPS 2024 - Predict New Medicines with BELKA &#8212; Primer Parcial Práctico - Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'belkafp';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Modelos: NeurIPS 2024 - Predict New Medicines with BELKA" href="belkasp.html" />
    <link rel="prev" title="Punto 1" href="ffile.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Primer Parcial Práctico - Machine Learning</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Ejercicio Notas de Clase (1.0 puntos)
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ffile.html"><strong>Punto 1</strong></a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">EDA: NeurIPS 2024 - Predict New Medicines with BELKA</a></li>
<li class="toctree-l1"><a class="reference internal" href="belkasp.html">Modelos: NeurIPS 2024 - Predict New Medicines with BELKA</a></li>
<li class="toctree-l1"><a class="reference internal" href="cell.html">Open Problems – Single-Cell Perturbations</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/belkafp.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EDA: NeurIPS 2024 - Predict New Medicines with BELKA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-la-base-de-datos">Análisis exploratorio de la base de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos-de-entrenamiento">Base de datos de entrenamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtracion-proteina-ephx2-seh">Filtración: proteína EPHX2 - (sEH)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-onehotencoder">Codificación: OneHotEncoder</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad-chi-cuadrado">Multicolinealidad: Chi-cuadrado</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtracion-proteina-brd4">Filtración: proteína BRD4</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Codificación: OneHotEncoder</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Multicolinealidad: Chi-cuadrado</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtracion-proteina-hsa">Filtración: proteína HSA</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Codificación: OneHotEncoder</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Multicolinealidad: Chi-cuadrado</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos-de-prueba">Base de datos de prueba</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="eda-neurips-2024-predict-new-medicines-with-belka">
<h1>EDA: NeurIPS 2024 - Predict New Medicines with BELKA<a class="headerlink" href="#eda-neurips-2024-predict-new-medicines-with-belka" title="Link to this heading">#</a></h1>
<section id="librerias">
<h2>Librerías<a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span><span class="n">chi2</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-exploratorio-de-la-base-de-datos">
<h2>Análisis exploratorio de la base de datos<a class="headerlink" href="#analisis-exploratorio-de-la-base-de-datos" title="Link to this heading">#</a></h2>
<p>Los medicamentos con moléculas reducidas son compuestos químicos que interactúan con las proteínas celulares. Estos regulan la actividad de las proteínas al inhibir su función, lo cual puede minimizar significativamente el impacto patológico de estas. En la actualidad, la identificación de moléculas candidatas necesita un enfoque bastante complejo, ya que requiere llevar a cabo una síntesis individual seguida de pruebas para confirmar su interacción con la proteína objetivo.</p>
<p>Aunque <code class="docutils literal notranslate"><span class="pre">la</span> <span class="pre">Administración</span> <span class="pre">de</span> <span class="pre">Alimentos</span> <span class="pre">y</span> <span class="pre">Medicamentos</span> <span class="pre">de</span> <span class="pre">Estados</span> <span class="pre">Unidos</span> <span class="pre">(FDA)</span></code> ha autorizado aproximadamente 2000 nuevas entidades moleculares, el número potencial de moléculas con propiedades farmacológicas efectivas es extremadamente alto, estimado en aproximadamente 10^60. Esta magnitud presenta un desafío considerable, ya que el proceso físico de búsqueda resulta prácticamente inviable para explorar todo este vasto espacio químico.</p>
<p>En esta ocasión, trabajaremos con datos proporcionados por <code class="docutils literal notranslate"><span class="pre">Leash</span> <span class="pre">Biosciences</span></code>, los cuales están representados mediante una clasificación binaria que indica si una molécula pequeña es un aglutinante de una de las tres proteínas o no. Estos datos se recopilaron utilizando la tecnología de la  biblioteca química codificada por ADN (DEL), generando así el conjunto de datos <code class="docutils literal notranslate"><span class="pre">Big</span> <span class="pre">Encoded</span> <span class="pre">Library</span> <span class="pre">for</span> <span class="pre">Chemical</span> <span class="pre">Assessment (BELKA)</span></code>.</p>
<p>Para este ejercicio, vamos a trabajar con dos bases de datos: <code class="docutils literal notranslate"><span class="pre">train</span></code> y <code class="docutils literal notranslate"><span class="pre">test</span></code> relacionadas con el problema a predecir.</p>
<p>Contamos con diferentes tipos de moléculas que vamos a estudiar con el fin de saber si esta está adherida o no a los 3 tipos de proteína de interés. Estas son:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EPHX2</span> <span class="pre">(sEH)</span></code>: <strong>epóxido hidrolasa 2 (EPHX2)</strong>, cuyo producto proteico es conocido como <strong>epóxido hidrolasa soluble (sEH)</strong>, es un objetivo farmacológico prometedor para tratar la hipertensión arterial y frenar la progresión de la diabetes.</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BRD4</span></code>: <strong>bromodomain 4 (BRD4)</strong>, codificado por el locus BRD4, produce una proteína que se une a histonas, proteínas en el núcleo que regulan la transcripción del ADN. Al influir en la expresión genética, juegan un papel clave en la progresión del cáncer, y se han desarrollado varios fármacos que inhiben su actividad.</p></li>
</ul>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ALB</span> <span class="pre">(HSA)</span></code>: <code class="docutils literal notranslate"><span class="pre">albúmina</span> <span class="pre">sérica</span> <span class="pre">(ALB)</span></code>, codificada por el locus ALB y también conocida como <code class="docutils literal notranslate"><span class="pre">HSA</span> <span class="pre">(albúmina</span> <span class="pre">sérica</span> <span class="pre">humana)</span></code>, es la proteína más abundante en la sangre. Su función principal es mantener la presión osmótica y transportar diversos ligandos, como hormonas y ácidos grasos.</p></li>
</ul>
<p>Veamos una descripción de las variables con las que estamos trabajando:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code>: identificador único.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">buildingblock1_smiles</span> </code>: la estructura, en SMILES, del primer bloque de construcción.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">buildingblock2_smiles</span></code>: la estructura, en SMILES, del segundo bloque de construcción.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">buildingblock3_smiles</span></code>: la estructura, en SMILES, del tercer bloque de construcción.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molecule_smiles</span></code>: la estructura de la molécula completamente ensamblada, en SMILES. Esto incluye los tres bloques de construcción y el núcleo de triazina. Es el ID de la molécula.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binds</span></code>: unión molécula-proteína. 0 - No, 1 - Sí</p></li>
</ul>
</section>
<section id="base-de-datos-de-entrenamiento">
<h2>Base de datos de entrenamiento<a class="headerlink" href="#base-de-datos-de-entrenamiento" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/Downloads/leash-BELKA/train.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>El conjunto de datos de entrenamiento, <code class="docutils literal notranslate"><span class="pre">train</span></code>, cuenta con un total de 295246830 observaciones y con 7 variables, las cuales ya fueron descritas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_train</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(295246830, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3cccc(Br)n3)nc(N[C@@H](CC...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3cccc(Br)n3)nc(N[C@@H](CC...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3cccc(Br)n3)nc(N[C@@H](CC...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3ccc(OCC#C)cc3)nc(N[C@@H]...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3ccc(OCC#C)cc3)nc(N[C@@H]...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3ccc(OCC#C)cc3)nc(N[C@@H]...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=C(C)C(=O)NCCN.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCCNC(=O)C(=C)C)nc(N[C@@H](C...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=C(C)C(=O)NCCN.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCCNC(=O)C(=C)C)nc(N[C@@H](C...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=C(C)C(=O)NCCN.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCCNC(=O)C(=C)C)nc(N[C@@H](C...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=CCNC(=O)CN.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCC(=O)NCC=C)nc(N[C@@H](CC#C...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=CCNC(=O)CN.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCC(=O)NCC=C)nc(N[C@@H](CC#C...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=CCNC(=O)CN.Cl</td>
      <td>C#CCOc1ccc(CNc2nc(NCC(=O)NCC=C)nc(N[C@@H](CC#C...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_train</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>295246815</th>
      <td>295246815</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1ncnc2c1ncn2C1CCCCO1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246816</th>
      <td>295246816</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1ncnc2c1ncn2C1CCCCO1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246817</th>
      <td>295246817</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1ncnc2c1ncn2C1CCCCO1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246818</th>
      <td>295246818</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nnc(S)s1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nnc(S)s2)nc(Nc2no...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246819</th>
      <td>295246819</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nnc(S)s1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nnc(S)s2)nc(Nc2no...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246820</th>
      <td>295246820</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nnc(S)s1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nnc(S)s2)nc(Nc2no...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246821</th>
      <td>295246821</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nncs1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nncs2)nc(Nc2noc3c...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246822</th>
      <td>295246822</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nncs1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nncs2)nc(Nc2noc3c...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246823</th>
      <td>295246823</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nncs1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nncs2)nc(Nc2noc3c...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246824</th>
      <td>295246824</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nnn[nH]1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nnn[nH]2)nc(Nc2no...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246825</th>
      <td>295246825</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nnn[nH]1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nnn[nH]2)nc(Nc2no...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246826</th>
      <td>295246826</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1nnn[nH]1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2nnn[nH]2)nc(Nc2no...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246827</th>
      <td>295246827</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246828</th>
      <td>295246828</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>295246829</th>
      <td>295246829</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(Nc2noc3ccc(F)cc23)nc...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Al visualizar las primeras y últimas 15 observaciones, respectivamente, podemos darnos cuenta de que se sigue un patrón en cuanto a los bloques y las moléculas. Dicho patrón es que el valor de estas 4 variables, se repite 3 veces dado que se realiza la comparación con cada una de las 3 proteínas.</p>
<p>Ahora, analicemos más de cerca las variables de nuestro conjunto de datos.</p>
<p>Primero, estudiemos la distribución de nuestra variable objetivo <code class="docutils literal notranslate"><span class="pre">binds</span></code>, la cual como ya se mencionó, indica si la molécula se adhirió o no a la proteína.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    293656924
1      1589906
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prctj</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">prctj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    99.461499
1     0.538501
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteinas</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;protein_name&#39;</span><span class="p">)[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteinas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>binds</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.995357</td>
      <td>0.004643</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.995850</td>
      <td>0.004150</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.992638</td>
      <td>0.007362</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nada más con estos cálculos podemos afirmar que la base de datos está <strong>muy</strong> desbalanceada.</p>
<p>Veamos esto gráficamente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;no aglutinante&#39;</span><span class="p">,</span> <span class="s1">&#39;aglutinante&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Unión molécula-proteína&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Relación entre molécula y variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4a9fab0b09a49dba5647ee5c86469cd89f9c315d8e63bac2736536714f629a9f.png" src="_images/4a9fab0b09a49dba5647ee5c86469cd89f9c315d8e63bac2736536714f629a9f.png" />
</div>
</div>
<p>En efecto, el gráfico coincide con los valores obtenidos, mostrando que la frecuencia de moléculas <strong>no aglutinantes</strong> es significativamente superior a la de las <strong>aglutinantes</strong>, pues el primer grupo representa el 99% de las observaciones, mientras que el segundo solo un 0.05%.</p>
<p>Es evidente el desequilibrio significativo de <code class="docutils literal notranslate"><span class="pre">binds</span></code>. Con esto se confirma que la mayoría de las observaciones corresponden a moléculas que no están unidas a una proteína.</p>
<p>Continuemos con las demás variables.</p>
<p>Para estas vamos a calcular la cantidad de valores únicos que hay en cada columna.</p>
<ul class="simple">
<li><p>buildingblock1_smiles</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque1</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>271
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>buildingblock2_smiles</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque2</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>693
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>buildingblock3_smiles</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque3</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>872
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>molecule_smiles</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moleculas</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">moleculas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98415610
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Datos de las variables</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bloque1</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque2</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque3</span><span class="p">],</span> <span class="p">[</span><span class="n">moleculas</span><span class="p">]]</span>

<span class="c1"># Crear tabla con plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">header</span><span class="p">),</span>
                               <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))])</span>

<span class="c1"># Mostrar la tabla</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<p>Podemos observar que la cantidad de moléculas con las que trabajamos es bastante superior comparado con la cantidad de valores únicos total de bloques, esto quiere decir que existen muchos más tipos de moléculas diferentes entre sí que de bloques.</p>
<p>Ahora, veamos si existen valores faltantes en este conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad_na</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">columna</span> <span class="ow">in</span> <span class="n">cantidad_na</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">columna</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cantidad_na</span><span class="p">[</span><span class="n">columna</span><span class="p">]</span><span class="si">}</span><span class="s2"> NA&#39;s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id: 0 NA&#39;s
buildingblock1_smiles: 0 NA&#39;s
buildingblock2_smiles: 0 NA&#39;s
buildingblock3_smiles: 0 NA&#39;s
molecule_smiles: 0 NA&#39;s
protein_name: 0 NA&#39;s
binds: 0 NA&#39;s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data_train</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data_train</span><span class="p">))</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:.2f}</span><span class="s1"> %&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id                       0.00 %
buildingblock1_smiles    0.00 %
buildingblock2_smiles    0.00 %
buildingblock3_smiles    0.00 %
molecule_smiles          0.00 %
protein_name             0.00 %
binds                    0.00 %
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">porcentaje_NA</span> <span class="o">=</span> <span class="n">data_train</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">data_faltante</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="n">porcentaje_NA</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="s1">&#39;percent_missing&#39;</span><span class="p">:</span> <span class="n">porcentaje_NA</span><span class="o">.</span><span class="n">values</span><span class="p">})</span>

<span class="n">data_faltante</span> <span class="o">=</span> <span class="n">data_faltante</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;percent_missing&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">data_faltante</span><span class="p">[</span><span class="s1">&#39;column&#39;</span><span class="p">],</span> <span class="n">data_faltante</span><span class="p">[</span><span class="s1">&#39;percent_missing&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Porcentaje de datos faltantes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Porcentaje de datos faltantes por variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/045e3c0c3958546b7aac024affe62d4291fb71c979f57497a3ca95235505c83c.png" src="_images/045e3c0c3958546b7aac024affe62d4291fb71c979f57497a3ca95235505c83c.png" />
</div>
</div>
<p>Es decir, <code class="docutils literal notranslate"><span class="pre">train</span></code> no cuenta con observaciones de tipo NA.
Esto es beneficioso para predecir de manera más precisa nuestro modelo.</p>
<p>Antes de seguir con el ejercicio, se va a realizar la siguiente aclaración:</p>
<p>Como ya se mencionó con anterioridad, esta base de datos contiene más de 200M de observaciones. En un principio, se intentó de diferentes maneras trabajar con este total, sin embargo, fue bastante complejo pues nuestra computadora con RAM de 16gb no soportaba en muchas ocasiones el peso de esta base de datos y de los diferentes procesos gastando mucho tiempo computacional y espacio de la RAM, lo cual terminaba relentizando y, a su vez, haciendo mucho más compleja la realización de esta actividad. Como primera solución, compramos Google Colab Pro, no obstante, esto no nos funcionó porque la RAM tampoco era suficiente para este conjunto.</p>
<p>Es por esta razón, que decidimos trabajar con la base de datos, filtrándola según el tipo de proteína y, además, reduciendo el número de observaciones a 100000 dado que por las circunstancias, se nos imposibilitaba trabajar con la base original.</p>
<p>En este orden de ideas, realizaremos las respectivas filtraciones trabajando cada conjunto de manera independiente para realizar sus respectivas predicciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_sEH</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sEH&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_BRD4</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BRD4&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_HSA</span> <span class="o">=</span> <span class="n">data_train</span><span class="p">[</span><span class="n">data_train</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HSA&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="filtracion-proteina-ephx2-seh">
<h3>Filtración: proteína EPHX2 - (sEH)<a class="headerlink" href="#filtracion-proteina-ephx2-seh" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_sEH</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span> <span class="n">data_sEH</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>  <span class="n">stratify</span> <span class="o">=</span> <span class="n">data_sEH</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_sEH</span><span class="o">.</span><span class="n">shape</span>      
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 7)
</pre></div>
</div>
</div>
</div>
<p>Ahora, calculemos la cantidad de valores únicos por variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque1_seh</span> <span class="o">=</span> <span class="n">data_sEH</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque1_seh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>271
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque2_seh</span> <span class="o">=</span> <span class="n">data_sEH</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque2_seh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>693
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque3_seh</span> <span class="o">=</span> <span class="n">data_sEH</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque3_seh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>872
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moleculas_seh</span> <span class="o">=</span> <span class="n">data_sEH</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">moleculas_seh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98415610
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Datos de las variables</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bloque1_seh</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque2_seh</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque3_seh</span><span class="p">],</span> <span class="p">[</span><span class="n">moleculas_seh</span><span class="p">]]</span>

<span class="c1"># Crear tabla con plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">header</span><span class="p">),</span>
                               <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))])</span>

<span class="c1"># Mostrar la tabla</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteina_seh</span> <span class="o">=</span> <span class="n">datatrain_sEH</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;protein_name&#39;</span><span class="p">)[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">proteina_seh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>binds</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.99264</td>
      <td>0.00736</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datatrain_sEH</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;no aglutinante&#39;</span><span class="p">,</span> <span class="s1">&#39;aglutinante&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Unión molécula-proteína&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Relación entre molécula y variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">proteina_seh</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/16237a641d778c238433f880ddbba60e8eccce31a30e96d0c4eff8165ad22a96.png" src="_images/16237a641d778c238433f880ddbba60e8eccce31a30e96d0c4eff8165ad22a96.png" />
</div>
</div>
<p><em><strong>datatrain_sEH</strong></em> es el dataframe creado a partir de la filtración con la proteína <code class="docutils literal notranslate"><span class="pre">sEH</span></code>. Como se mencionó antes, dada la gran cantidad de datos, se decidió tomar 100000 observaciones aleatorias que representan al conjunto de entrenamiento.
Esto lo podemos observar pues la cantidad de valores únicos coincide con la de la base de datos original, al igual que la distribución de la variable binaria <code class="docutils literal notranslate"><span class="pre">binds</span></code>.</p>
<p>Comprobemos que no hayan valores NA tal como en la base de entrenamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad_na</span> <span class="o">=</span> <span class="n">datatrain_sEH</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">columna</span> <span class="ow">in</span> <span class="n">cantidad_na</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">columna</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cantidad_na</span><span class="p">[</span><span class="n">columna</span><span class="p">]</span><span class="si">}</span><span class="s2"> NA&#39;s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id: 0 NA&#39;s
buildingblock1_smiles: 0 NA&#39;s
buildingblock2_smiles: 0 NA&#39;s
buildingblock3_smiles: 0 NA&#39;s
molecule_smiles: 0 NA&#39;s
protein_name: 0 NA&#39;s
binds: 0 NA&#39;s
</pre></div>
</div>
</div>
</div>
<p>Ahora, con ayuda de <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> se codificará la base de datos que contiene las observaciones de la proteína <strong>sEH</strong>.</p>
<section id="codificacion-onehotencoder">
<h4>Codificación: OneHotEncoder<a class="headerlink" href="#codificacion-onehotencoder" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_seh</span> <span class="o">=</span> <span class="n">datatrain_sEH</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Cabe resaltar que la variable <code class="docutils literal notranslate"><span class="pre">molecules_smiles</span></code> puede ser interpretada como un ID, pues cada valor en esta variable corresponde a un nombre que identifica de manera única a una molécula. Dado que actúa únicamente como un identificador y no proporciona información relevante para nuestro modelo, no la vamos a incluir en la codificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catcol_seh</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span>
<span class="n">encoder_seh</span> <span class="o">=</span>   <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">encoded_seh</span> <span class="o">=</span> <span class="n">encoder_seh</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datatrain_seh</span><span class="p">[</span><span class="n">catcol_seh</span><span class="p">])</span>
<span class="n">data_encodedseh</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoded_seh</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder_seh</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">catcol_seh</span><span class="p">))</span>
<span class="n">datatrainseh</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">datatrain_seh</span><span class="p">,</span><span class="n">data_encodedseh</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">datatrainseh</span><span class="o">=</span> <span class="n">datatrainseh</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">catcol_seh</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainseh</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule_smiles</th>
      <th>binds</th>
      <th>protein_name_sEH</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>268370342</td>
      <td>268370342</td>
      <td>Cc1cc(Nc2nc(Nc3cc(Cl)c(F)c(Cl)c3)nc(N[C@H](CC(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10026182</td>
      <td>10026182</td>
      <td>C=CC[C@H](Nc1nc(NCC2(COC)CCCCC2)nc(Nc2ccc(F)c(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23512220</td>
      <td>23512220</td>
      <td>CCS(=O)(=O)c1cc(C(=O)N[Dy])c(OC)cc1Nc1nc(NC[C@...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61878314</td>
      <td>61878314</td>
      <td>Cc1ccccc1[C@@H](CC(=O)N[Dy])Nc1nc(NCc2nc3c(s2)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>253580711</td>
      <td>253580711</td>
      <td>CC1(C)NC(=O)N(CCCNc2nc(NCc3cccnc3)nc(N[C@@H](C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>47632394</td>
      <td>47632394</td>
      <td>Cc1cc(Br)c(C(=O)N[Dy])cc1Nc1nc(NCCc2ccncc2F)nc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>214744424</td>
      <td>214744424</td>
      <td>CCOC(=O)c1ncccc1Nc1nc(Nc2cccc([N+](=O)[O-])c2C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>42487106</td>
      <td>42487106</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCn4ccnc43)nc(Nc3cnc(SC...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>149389373</td>
      <td>149389373</td>
      <td>COc1ccc(CNc2nc(NCC3CCC(C(=O)N(C)C)O3)nc(Nc3c(F...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>142007936</td>
      <td>142007936</td>
      <td>Cc1cc(Nc2nc(Nc3nc(-c4cccc([N+](=O)[O-])c4)cs3)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>9849104</td>
      <td>9849104</td>
      <td>C=CC[C@H](Nc1nc(NCC(C)(CC(C)C)NC(=O)c2cc(Cl)c(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>203169899</td>
      <td>203169899</td>
      <td>O=C(N[Dy])c1cc(I)ccc1Nc1nc(NCc2ccsc2)nc(NCc2nn...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>75165194</td>
      <td>75165194</td>
      <td>CCOC(=O)c1cc(Nc2nc(Nc3nccs3)nc(NC(Cc3ccccc3)C(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>191848106</td>
      <td>191848106</td>
      <td>CCN1C(=O)C[C@H](CNc2nc(NC[C@H]3CC(=O)N(CC)[C@@...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>237865790</td>
      <td>237865790</td>
      <td>CCOC(=O)c1sc(Nc2nc(NCC3(CC(=O)N[Dy])CCCCC3)nc(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 1838 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainseh</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule_smiles</th>
      <th>binds</th>
      <th>protein_name_sEH</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99985</th>
      <td>110594819</td>
      <td>110594819</td>
      <td>C=CCOC(C)CNc1nc(NCC2CC3(C2)CC3(F)F)nc(N[C@@H]2...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99986</th>
      <td>206817857</td>
      <td>206817857</td>
      <td>Cn1ccnc1Cn1c(CCCNc2nc(Nc3ccc(F)c(Cl)c3)nc(Nc3c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99987</th>
      <td>95503043</td>
      <td>95503043</td>
      <td>O=C1CSC(Nc2nc(Nc3cnc(Cl)c(Cl)c3)nc(N[C@@H](Cc3...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99988</th>
      <td>266273570</td>
      <td>266273570</td>
      <td>Cc1nn(C)c2ncc(CNc3nc(NCc4ccc5scnc5c4)nc(N[C@H]...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99989</th>
      <td>56614190</td>
      <td>56614190</td>
      <td>CNC(=O)COCCNc1nc(Nc2ncc(Cl)c(Cl)n2)nc(NC(CC(=O...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99990</th>
      <td>50279990</td>
      <td>50279990</td>
      <td>CNC(=O)COCCNc1nc(NCC2CCC(C(=O)N(C)C)O2)nc(Nc2c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99991</th>
      <td>160111940</td>
      <td>160111940</td>
      <td>COc1ccc(Nc2nc(Nc3cc(Br)cc(C(=O)N[Dy])c3)nc(Nc3...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99992</th>
      <td>291714953</td>
      <td>291714953</td>
      <td>CC(O)(CNc1nc(NCc2cccnc2)nc(N2CCOC[C@@H]2C(=O)N...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99993</th>
      <td>68271803</td>
      <td>68271803</td>
      <td>CN(C)c1ncccc1CNc1nc(NC2=NC(=O)CS2)nc(Nc2ccc(C#...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99994</th>
      <td>20301830</td>
      <td>20301830</td>
      <td>CCC(C)C(Nc1nc(NCC(c2cncn2C)N2CCCC2)nc(Nc2ccc(C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>150076328</td>
      <td>150076328</td>
      <td>Cc1ccc(Nc2nc(NCc3ccccn3)nc(Nc3c(F)cc(C(=O)N[Dy...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>224683622</td>
      <td>224683622</td>
      <td>COc1cc(Nc2nc(Nc3ncc([N+](=O)[O-])s3)nc(Nc3nc(C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>156827837</td>
      <td>156827837</td>
      <td>Cc1cc(Nc2nc(Nc3nc(-c4cccnc4)cs3)nc(Nc3cc(-n4cc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>91838225</td>
      <td>91838225</td>
      <td>COC(CNc1nc(NCc2cncc(Br)c2C)nc(N[C@@H](Cc2cc(F)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>179204738</td>
      <td>179204738</td>
      <td>Cn1cc(CNc2nc(NCC3(C4CC4)CCCO3)nc(Nc3cc4ccccc4c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 1838 columns</p>
</div></div></div>
</div>
<p>En efecto, observamos que se realizó la codificación de nuestro dataset y ya está listo para proceder a realizar la evaluación de multicolinealidad con <code class="docutils literal notranslate"><span class="pre">Chi-cuadrado</span></code>.</p>
</section>
<section id="multicolinealidad-chi-cuadrado">
<h4>Multicolinealidad: Chi-cuadrado<a class="headerlink" href="#multicolinealidad-chi-cuadrado" title="Link to this heading">#</a></h4>
<p>En este apartado, nuestro objetivo es identificar cuáles columnas tienen un alto nivel de correlación entre sí para eliminar algunas de ellas.</p>
<p>Para esto, podemos usar la prueba <code class="docutils literal notranslate"><span class="pre">Chi-cuadrado</span></code> con la función <code class="docutils literal notranslate"><span class="pre">chi2_contingency()</span></code>, que nos ayuda a evaluar la relación entre variables categróricas y, posteriormente, eliminar columnas de manera manual. Sin embargo, en las aplicaciones de Machine Learning, existe un método llamado <code class="docutils literal notranslate"><span class="pre">SelectKBest</span></code>, el cual realiza ambos procesos en una misma función. Utilizando este método basándose en <code class="docutils literal notranslate"><span class="pre">chi2</span></code>, podemos seleccionar las características más relevantes (variables más asociadas y que mejor predicen a la objetivo) y eliminar automáticamente las menos importantes en la base de datos para realizar un mejor modelo.</p>
<p>Lo primero que haremos será eliminar la columna <code class="docutils literal notranslate"><span class="pre">molecule_smiles</span></code> de nuestro conjunto de datos. Como se mencionó anteriormente, esta columna no se codificó ya que no es relevante para nuestro estudio, porque solo representa un identificador único para cada molécula, es decir, el nombre de estas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainseh</span> <span class="o">=</span> <span class="n">datatrainseh</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainseh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>binds</th>
      <th>protein_name_sEH</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>268370342</td>
      <td>268370342</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10026182</td>
      <td>10026182</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23512220</td>
      <td>23512220</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61878314</td>
      <td>61878314</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>253580711</td>
      <td>253580711</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1837 columns</p>
</div></div></div>
</div>
<p>Ahora, procederemos a realizar la evaluación de multicolinealidad y eliminación de columnas no relevantes.</p>
<p>Nuestro criterio de evaluación para la relevancia de las variables se basa en seleccionar las 150 características que muestran una fuerte asociación con nuestra variable objetivo basado en los resultados arrojados por la función <code class="docutils literal notranslate"><span class="pre">SelectKBest</span></code> y la prueba <code class="docutils literal notranslate"><span class="pre">chi2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unionseh</span> <span class="o">=</span> <span class="n">datatrainseh</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span>

<span class="n">bestseh</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>  
<span class="n">X_seh</span> <span class="o">=</span> <span class="n">bestseh</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datatrainseh</span><span class="p">,</span> <span class="n">unionseh</span><span class="p">)</span>

<span class="n">caracselec_seh</span> <span class="o">=</span> <span class="n">bestseh</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">colineal_seh</span> <span class="o">=</span> <span class="n">datatrainseh</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">caracselec_seh</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colineal_seh</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>binds</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CC(C)CC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_COc1cc(C(=O)O)c(N)cc1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_Cc1cc(Br)c(C(=O)O)cc1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(NCC1CCC(C(=O)O)CC1)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(NC[C@H]1CC[C@H](C(=O)O)CC1)OCC1c2ccccc2-c2ccccc21</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1cc(Cl)c([N+](=O)[O-])cn1</th>
      <th>buildingblock3_smiles_Nc1ccc(Cl)nc1</th>
      <th>buildingblock3_smiles_Nc1ccc(Cl)nc1Cl</th>
      <th>buildingblock3_smiles_Nc1ccc(F)c([N+](=O)[O-])c1</th>
      <th>buildingblock3_smiles_Nc1ccc(N2CCC=C(N3CCOCC3)C2=O)cc1</th>
      <th>buildingblock3_smiles_Nc1ccc(OC(F)F)cc1</th>
      <th>buildingblock3_smiles_Nc1ccc2ncoc2c1</th>
      <th>buildingblock3_smiles_Nc1nc(-c2ccc(Cl)c(Cl)c2)cs1</th>
      <th>buildingblock3_smiles_Nc1ncc(Cl)cc1F</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>268370342</td>
      <td>268370342</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10026182</td>
      <td>10026182</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23512220</td>
      <td>23512220</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>61878314</td>
      <td>61878314</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>253580711</td>
      <td>253580711</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 150 columns</p>
</div></div></div>
</div>
<p>Finalmente nos quedaremos con <code class="docutils literal notranslate"><span class="pre">colineal_seh</span></code> como base de datos de entrenamiento para la realización del modelo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colineal_seh</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;datatrainsEH.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="filtracion-proteina-brd4">
<h3>Filtración: proteína BRD4<a class="headerlink" href="#filtracion-proteina-brd4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_BRD4</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_BRD4</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>  <span class="n">stratify</span> <span class="o">=</span> <span class="n">data_BRD4</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_BRD4</span><span class="o">.</span><span class="n">shape</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 7)
</pre></div>
</div>
</div>
</div>
<p>Calculemos el total de valores únicos por variable y la distribución de <code class="docutils literal notranslate"><span class="pre">binds</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque1_BRD4</span> <span class="o">=</span> <span class="n">data_BRD4</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque1_BRD4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>271
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque2_BRD4</span> <span class="o">=</span> <span class="n">data_BRD4</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque2_BRD4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>693
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque3_BRD4</span> <span class="o">=</span> <span class="n">data_BRD4</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque3_BRD4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>872
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moleculas_BRD4</span> <span class="o">=</span> <span class="n">data_BRD4</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">moleculas_BRD4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98415610
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Datos de las variables</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bloque1_BRD4</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque2_BRD4</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque3_BRD4</span><span class="p">],</span> <span class="p">[</span><span class="n">moleculas_BRD4</span><span class="p">]]</span>

<span class="c1"># Crear tabla con plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">header</span><span class="p">),</span>
                               <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))])</span>

<span class="c1"># Mostrar la tabla</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteina_BRD4</span> <span class="o">=</span> <span class="n">datatrain_BRD4</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;protein_name&#39;</span><span class="p">)[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">proteina_BRD4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>binds</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.99536</td>
      <td>0.00464</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datatrain_BRD4</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;no aglutinante&#39;</span><span class="p">,</span> <span class="s1">&#39;aglutinante&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Unión molécula-proteína&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Relación entre molécula y variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">proteina_BRD4</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c519d14e500fe2bf9445d4ab603821a0fe547c30e205c391930f14edd6f98dc7.png" src="_images/c519d14e500fe2bf9445d4ab603821a0fe547c30e205c391930f14edd6f98dc7.png" />
</div>
</div>
<p><em><strong>datatrain_BRD4</strong></em> es el dataframe creado a partir de la filtración con la proteína <code class="docutils literal notranslate"><span class="pre">BRD4</span></code>. Al igual que con la proteína, <code class="docutils literal notranslate"><span class="pre">sEH</span></code>, se tomaron 100000 observaciones aleatorias que representan al conjunto de entrenamiento.
Esto lo podemos observar pues la cantidad de valores únicos coincide con la de la base de datos original, al igual que la distribución de la variable binaria <code class="docutils literal notranslate"><span class="pre">binds</span></code>.</p>
<p>Comprobemos que no hayan valores NA tal como en la base de entrenamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad_na</span> <span class="o">=</span> <span class="n">datatrain_BRD4</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">columna</span> <span class="ow">in</span> <span class="n">cantidad_na</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">columna</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cantidad_na</span><span class="p">[</span><span class="n">columna</span><span class="p">]</span><span class="si">}</span><span class="s2"> NA&#39;s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id: 0 NA&#39;s
buildingblock1_smiles: 0 NA&#39;s
buildingblock2_smiles: 0 NA&#39;s
buildingblock3_smiles: 0 NA&#39;s
molecule_smiles: 0 NA&#39;s
protein_name: 0 NA&#39;s
binds: 0 NA&#39;s
</pre></div>
</div>
</div>
</div>
<p>Ahora, con ayuda de <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> se codificará la base de datos que contiene las observaciones de la proteína <strong>BRD4</strong>.</p>
<section id="id1">
<h4>Codificación: OneHotEncoder<a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_brd4</span> <span class="o">=</span> <span class="n">datatrain_BRD4</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Nuevamente dejamos de lado a la variable <code class="docutils literal notranslate"><span class="pre">molecule_smiles</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catcol_brd4</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span>
<span class="n">encoder_brd4</span> <span class="o">=</span>   <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">encoded_brd4</span> <span class="o">=</span> <span class="n">encoder_brd4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datatrain_brd4</span><span class="p">[</span><span class="n">catcol_brd4</span><span class="p">])</span>
<span class="n">data_encodedbrd4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoded_brd4</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder_brd4</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">catcol_brd4</span><span class="p">))</span>
<span class="n">datatrainbrd4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">datatrain_brd4</span><span class="p">,</span><span class="n">data_encodedbrd4</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">datatrainbrd4</span> <span class="o">=</span> <span class="n">datatrainbrd4</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">catcol_brd4</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainbrd4</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule_smiles</th>
      <th>binds</th>
      <th>protein_name_BRD4</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30461271</td>
      <td>30461271</td>
      <td>COc1cc(C(=O)N[Dy])c(N)cc1Nc1nc(NCc2c(C)sc(C)c2...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>259257822</td>
      <td>259257822</td>
      <td>O=C(C[C@@H](Nc1nc(Nc2ccc3c(c2)COC3=O)nc(Nc2ncc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101635230</td>
      <td>101635230</td>
      <td>CS(=O)CCCCNc1nc(NC[C@H]2CC[C@H](C(N)=O)CC2)nc(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19527021</td>
      <td>19527021</td>
      <td>CC(OC(C)(C)C)C(Nc1nc(Nc2ccnc(Cl)c2)nc(Nc2ccc(=...</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187891824</td>
      <td>187891824</td>
      <td>O=C(N[Dy])c1ccc(Nc2nc(NCc3ccc[n+]([O-])c3)nc(N...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>68837628</td>
      <td>68837628</td>
      <td>COC(=O)c1nc(Cl)c(Cl)nc1Nc1nc(Nc2nccc3cccnc23)n...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>72906105</td>
      <td>72906105</td>
      <td>O=C(N[Dy])C(CC1CCCCC1)Nc1nc(Nc2cc(C(F)(F)F)cc(...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>152970567</td>
      <td>152970567</td>
      <td>COC1CCC(CCNc2nc(Nc3nnc(C)s3)nc(Nc3c(I)c(C(=O)O...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>180019656</td>
      <td>180019656</td>
      <td>COc1ccc(C)nc1CNc1nc(NCCOc2cccnc2)nc(Nc2ccc(Br)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>243548469</td>
      <td>243548469</td>
      <td>O=C(C[C@@H](Cc1ccc(Br)cc1)Nc1nc(NCCCOc2cccc(F)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>27014637</td>
      <td>27014637</td>
      <td>COC(=O)CC(Nc1nc(Nc2cnccn2)nc(Nc2cc(F)c(F)cc2[N...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>138412248</td>
      <td>138412248</td>
      <td>Cc1nn(CCNc2nc(NCC(C)OC(C)(C)C)nc(Nc3c(C(=O)N[D...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>248210646</td>
      <td>248210646</td>
      <td>O=C(C[C@@H](Cc1ccc(Cl)cc1Cl)Nc1nc(NCc2nc(-c3cc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>222625326</td>
      <td>222625326</td>
      <td>Cc1cc(Nc2nc(Nc3cncnc3)nc(Nc3nc(-c4ccc(C(=O)N[D...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>150823647</td>
      <td>150823647</td>
      <td>O=C(N[Dy])c1c(Br)ccc(F)c1Nc1nc(NCCc2nc3c(s2)CO...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 1837 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainbrd4</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule_smiles</th>
      <th>binds</th>
      <th>protein_name_BRD4</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99985</th>
      <td>96041997</td>
      <td>96041997</td>
      <td>COC(=O)c1cc(F)c(F)cc1Nc1nc(Nc2nc3c(s2)CN(C(=O)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99986</th>
      <td>40341102</td>
      <td>40341102</td>
      <td>COc1nccc(C(=O)N[Dy])c1Nc1nc(Nc2ccccc2N2CCN(C(=...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99987</th>
      <td>141738897</td>
      <td>141738897</td>
      <td>CCOC(=O)c1csc(Nc2nc(Nc3nc(C(=O)OCC)cs3)nc(Nc3c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99988</th>
      <td>222486360</td>
      <td>222486360</td>
      <td>CCON(C)C(=O)CNc1nc(NCc2c(F)ccc(F)c2OC)nc(Nc2nc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99989</th>
      <td>88778394</td>
      <td>88778394</td>
      <td>N#Cc1ccc(CNc2nc(Nc3ccc(-c4ncc[nH]4)cc3)nc(N[C@...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99990</th>
      <td>243886491</td>
      <td>243886491</td>
      <td>O=C(C[C@@H](Cc1ccc(Br)cc1)Nc1nc(Nc2ccc(OC(F)F)...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99991</th>
      <td>54883578</td>
      <td>54883578</td>
      <td>Cc1ccc(C(=O)N[Dy])cc1Nc1nc(NCc2c(C)nn(-c3ccccc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99992</th>
      <td>265005852</td>
      <td>265005852</td>
      <td>COc1ccc(Nc2nc(NCC3CCN(c4ccncc4)CC3)nc(N[C@H](C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99993</th>
      <td>4882833</td>
      <td>4882833</td>
      <td>C#CC[C@H](Nc1nc(NCc2nnc3n2CCOCC3)nc(NCC(C)c2nc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99994</th>
      <td>16161186</td>
      <td>16161186</td>
      <td>CC(C)(C)OC(=O)N1C[C@@H](Nc2nc(NCc3cnc(N4CCOCC4...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>4810647</td>
      <td>4810647</td>
      <td>C#CC[C@H](Nc1nc(NCCc2nc(-c3ccccc3)c(C)s2)nc(Nc...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>11532018</td>
      <td>11532018</td>
      <td>CC(=O)c1ccc(C[C@H](Nc2nc(NC[C@H]3CC[C@H](C(N)=...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>45267540</td>
      <td>45267540</td>
      <td>CSc1ccc(CNc2nc(NCCCOc3cccc(F)c3)nc(N3CCC[C@@]3...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>227278032</td>
      <td>227278032</td>
      <td>N#Cc1cnn(-c2ccccc2)c1Nc1nc(NCc2ncon2)nc(Nc2nc3...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>55462125</td>
      <td>55462125</td>
      <td>Cc1ccc(C(=O)N[Dy])cc1Nc1nc(Nc2cccc3[nH]ccc23)n...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 1837 columns</p>
</div></div></div>
</div>
<p>Procederemos entonces a realizar la evaluación de la multicolinealidad.</p>
</section>
<section id="id2">
<h4>Multicolinealidad: Chi-cuadrado<a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<p>Eliminaremos primeramente la variable <code class="docutils literal notranslate"><span class="pre">molecule_smiles</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainbrd4</span> <span class="o">=</span> <span class="n">datatrainbrd4</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainbrd4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>binds</th>
      <th>protein_name_BRD4</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30461271</td>
      <td>30461271</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>259257822</td>
      <td>259257822</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101635230</td>
      <td>101635230</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19527021</td>
      <td>19527021</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187891824</td>
      <td>187891824</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>4810647</td>
      <td>4810647</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>11532018</td>
      <td>11532018</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>45267540</td>
      <td>45267540</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>227278032</td>
      <td>227278032</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>55462125</td>
      <td>55462125</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 1836 columns</p>
</div></div></div>
</div>
<p>Nuevamente haremos uso de la función <code class="docutils literal notranslate"><span class="pre">SelectKBest</span></code> con k= 150.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unionbrd4</span> <span class="o">=</span> <span class="n">datatrainbrd4</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span>

<span class="n">bestbrd4</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>  
<span class="n">X_brd4</span> <span class="o">=</span> <span class="n">bestbrd4</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datatrainbrd4</span><span class="p">,</span> <span class="n">unionbrd4</span><span class="p">)</span>

<span class="n">caracselec_brd4</span> <span class="o">=</span> <span class="n">bestbrd4</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">colineal_brd4</span> <span class="o">=</span> <span class="n">datatrainbrd4</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">caracselec_brd4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colineal_brd4</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>binds</th>
      <th>buildingblock1_smiles_CC(C)(C)OC(=O)CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CC(C)(C)OCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CC(C)CC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CC(OC(C)(C)C)C(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CCC(C)C(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CCCCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_COc1ccc(C(=O)O)c(NC(=O)OCC2c3ccccc3-c3ccccc32)c1</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ccc(Cl)nc1</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)C(O)CCC2</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)CCC2=O</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)CCCC2=O</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)CNC2=O</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)COC2=O</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)OCO2</th>
      <th>buildingblock3_smiles_Nc1nc2c(s1)CN(C(=O)OCc1ccccc1)CC2</th>
      <th>buildingblock3_smiles_Nc1nc[nH]n1</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>30461271</td>
      <td>30461271</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>259257822</td>
      <td>259257822</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>101635230</td>
      <td>101635230</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>19527021</td>
      <td>19527021</td>
      <td>1</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>187891824</td>
      <td>187891824</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>4810647</td>
      <td>4810647</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>11532018</td>
      <td>11532018</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>45267540</td>
      <td>45267540</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>227278032</td>
      <td>227278032</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>55462125</td>
      <td>55462125</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 150 columns</p>
</div></div></div>
</div>
<p>Finalmente nos quedaremos con esta nueva base, <code class="docutils literal notranslate"><span class="pre">colineal_brd4</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colineal_brd4</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;datatrainbrd4.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="filtracion-proteina-hsa">
<h3>Filtración: proteína HSA<a class="headerlink" href="#filtracion-proteina-hsa" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_HSA</span><span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data_HSA</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span>  <span class="n">stratify</span> <span class="o">=</span> <span class="n">data_HSA</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_HSA</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 7)
</pre></div>
</div>
</div>
</div>
<p>Ahora, encontremos la cantidad de valores únicos por variable al igual que la distribución de la objetivo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque1_HSA</span> <span class="o">=</span> <span class="n">data_HSA</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque1_HSA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>271
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque2_HSA</span> <span class="o">=</span> <span class="n">data_HSA</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque2_HSA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>693
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloque3_HSA</span> <span class="o">=</span> <span class="n">data_HSA</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">bloque3_HSA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>872
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">moleculas_HSA</span> <span class="o">=</span> <span class="n">data_HSA</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">moleculas_HSA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98415610
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>

<span class="c1"># Datos de las variables</span>
<span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_smiles&#39;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[[</span><span class="n">bloque1_HSA</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque2_HSA</span><span class="p">],</span> <span class="p">[</span><span class="n">bloque3_HSA</span><span class="p">],</span> <span class="p">[</span><span class="n">moleculas_HSA</span><span class="p">]]</span>

<span class="c1"># Crear tabla con plotly</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Table</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">header</span><span class="p">),</span>
                               <span class="n">cells</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">))])</span>

<span class="c1"># Mostrar la tabla</span>
<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteina_HSA</span> <span class="o">=</span> <span class="n">datatrain_HSA</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;protein_name&#39;</span><span class="p">)[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">proteina_HSA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>binds</th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.99585</td>
      <td>0.00415</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;binds&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">datatrain_HSA</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;#3f3e6fd1&quot;</span><span class="p">,</span> <span class="s2">&quot;#85c6a9&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;no aglutinante&#39;</span><span class="p">,</span> <span class="s1">&#39;aglutinante&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Unión molécula-proteína&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Relación entre molécula y variable&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">proteina_HSA</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">),</span> <span class="n">horizontalalignment</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">14</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">fontweight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a8ac93c0eae410ac0d52c9b5550da25d52c14bb2ab35feec6ba00e07a83854e7.png" src="_images/a8ac93c0eae410ac0d52c9b5550da25d52c14bb2ab35feec6ba00e07a83854e7.png" />
</div>
</div>
<p><em><strong>datatrain_HSA</strong></em> es el dataframe creado a partir de la filtración con la proteína <code class="docutils literal notranslate"><span class="pre">HSA</span></code>. Nuevamente se tomaron 100000 observaciones aleatorias que representan al conjunto de entrenamiento.
Esto lo podemos observar pues la cantidad de valores únicos coincide con la de la base de datos original, al igual que la distribución de la variable binaria <code class="docutils literal notranslate"><span class="pre">binds</span></code>.</p>
<p>Comprobemos que no hayan valores NA tal como en la base de entrenamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cantidad_na</span> <span class="o">=</span> <span class="n">datatrain_HSA</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">for</span> <span class="n">columna</span> <span class="ow">in</span> <span class="n">cantidad_na</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">columna</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cantidad_na</span><span class="p">[</span><span class="n">columna</span><span class="p">]</span><span class="si">}</span><span class="s2"> NA&#39;s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id: 0 NA&#39;s
buildingblock1_smiles: 0 NA&#39;s
buildingblock2_smiles: 0 NA&#39;s
buildingblock3_smiles: 0 NA&#39;s
molecule_smiles: 0 NA&#39;s
protein_name: 0 NA&#39;s
binds: 0 NA&#39;s
</pre></div>
</div>
</div>
</div>
<p>Ahora, con ayuda de <code class="docutils literal notranslate"><span class="pre">OneHotEncoder</span></code> se codificará la base de datos que contiene las observaciones de la proteína <strong>HSA</strong>.</p>
<section id="id3">
<h4>Codificación: OneHotEncoder<a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrain_hsa</span> <span class="o">=</span> <span class="n">datatrain_HSA</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catcol_hsa</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span> <span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span>
<span class="n">encoder_hsa</span> <span class="o">=</span>   <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">encoded_hsa</span> <span class="o">=</span> <span class="n">encoder_hsa</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datatrain_hsa</span><span class="p">[</span><span class="n">catcol_hsa</span><span class="p">])</span>
<span class="n">data_encodedhsa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">encoded_hsa</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder_hsa</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">catcol_hsa</span><span class="p">))</span>
<span class="n">datatrainhsa</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">datatrain_hsa</span><span class="p">,</span><span class="n">data_encodedhsa</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">datatrainhsa</span> <span class="o">=</span> <span class="n">datatrainhsa</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">catcol_hsa</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainhsa</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule_smiles</th>
      <th>binds</th>
      <th>protein_name_HSA</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>139082035</td>
      <td>139082035</td>
      <td>Cc1cc(Nc2nc(NC3=NC(=O)CS3)nc(Nc3c(C(=O)N[Dy])c...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>141222220</td>
      <td>141222220</td>
      <td>Cn1cc(-c2ccccc2CNc2nc(NCC3(c4ccc5c(c4)OCO5)CCC...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16664275</td>
      <td>16664275</td>
      <td>CSSCCNc1nc(NCc2cnc(N3CCOCC3)c(F)c2)nc(NC(COC(C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>88223383</td>
      <td>88223383</td>
      <td>O=C(N[Dy])[C@H](C/C=C/c1ccccc1)Nc1nc(NCc2cc(=O...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>183198910</td>
      <td>183198910</td>
      <td>CNC(=O)c1cc(Oc2ccc(Nc3nc(Nc4ccc(C(=O)N[Dy])c(C...</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1837 columns</p>
</div></div></div>
</div>
<p>Ahora, a realizar la evaluación de la multicolinealidad.</p>
</section>
<section id="id4">
<h4>Multicolinealidad: Chi-cuadrado<a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>Eliminaremos primeramente la variable <code class="docutils literal notranslate"><span class="pre">molecule_smiles</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainhsa</span> <span class="o">=</span> <span class="n">datatrainhsa</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;molecule_smiles&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datatrainhsa</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>binds</th>
      <th>protein_name_HSA</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>139082035</td>
      <td>139082035</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>141222220</td>
      <td>141222220</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16664275</td>
      <td>16664275</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>88223383</td>
      <td>88223383</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>183198910</td>
      <td>183198910</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1836 columns</p>
</div></div></div>
</div>
<p>Otra vez haremos uso de la función <code class="docutils literal notranslate"><span class="pre">SelectKBest</span></code> con k= 150 para reducir la dimensionalidad de la base.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unionhsa</span> <span class="o">=</span> <span class="n">datatrainhsa</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span>

<span class="n">besthsa</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">150</span><span class="p">)</span>  
<span class="n">X_hsa</span> <span class="o">=</span> <span class="n">besthsa</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">datatrainhsa</span><span class="p">,</span> <span class="n">unionhsa</span><span class="p">)</span>

<span class="n">caracselec_hsa</span> <span class="o">=</span> <span class="n">besthsa</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
<span class="n">colineal_hsa</span> <span class="o">=</span> <span class="n">datatrainhsa</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">caracselec_hsa</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colineal_hsa</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>binds</th>
      <th>buildingblock1_smiles_CC(C)(C)OCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CC(C)CC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_CC(OC(C)(C)C)C(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_Cc1c(Br)ccc(C(=O)O)c1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_Cc1cc(C(=O)O)ccc1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_Cc1cc(C)c(NC(=O)OCC2c3ccccc3-c3ccccc32)c(C(=O)O)c1</th>
      <th>buildingblock1_smiles_Cc1cc(Cl)cc(C(=O)O)c1NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1cncc(F)c1</th>
      <th>buildingblock3_smiles_Nc1cncnc1</th>
      <th>buildingblock3_smiles_Nc1n[nH]c2cc(F)ccc12</th>
      <th>buildingblock3_smiles_Nc1n[nH]c2ccc([N+](=O)[O-])cc12</th>
      <th>buildingblock3_smiles_Nc1nc2c(Br)cccc2s1</th>
      <th>buildingblock3_smiles_Nc1nc2ccc(Cl)cc2s1</th>
      <th>buildingblock3_smiles_Nc1nc[nH]n1</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>139082035</td>
      <td>139082035</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>141222220</td>
      <td>141222220</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16664275</td>
      <td>16664275</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>88223383</td>
      <td>88223383</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>183198910</td>
      <td>183198910</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>136745806</td>
      <td>136745806</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>263887213</td>
      <td>263887213</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>36252772</td>
      <td>36252772</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>16054936</td>
      <td>16054936</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>71269633</td>
      <td>71269633</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 150 columns</p>
</div></div></div>
</div>
<p>Finalmente nos quedaremos con esta nueva base, <code class="docutils literal notranslate"><span class="pre">colineal_hsa</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">colineal_hsa</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;datatrainhsa.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="base-de-datos-de-prueba">
<h2>Base de datos de prueba<a class="headerlink" href="#base-de-datos-de-prueba" title="Link to this heading">#</a></h2>
<p>Primero, importamos el conjunto de datos de nuestro interés.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:/Users/valcd/Downloads/leash-BELKA/test.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_test</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>295246830</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>295246831</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>295246832</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>3</th>
      <td>295246833</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ncnc3c2...</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>295246834</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ncnc3c2...</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1674891</th>
      <td>296921721</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>COC1CCC(CCN)CC1</td>
      <td>COC1CCC(CCNc2nc(Nc3noc4ccc(F)cc34)nc(N[C@@H](C...</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>1674892</th>
      <td>296921722</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>COC1CCC(CCN)CC1</td>
      <td>COC1CCC(CCNc2nc(Nc3noc4ccc(F)cc34)nc(N[C@@H](C...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>1674893</th>
      <td>296921723</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>NCc1cccs1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(NCc2cccs2)nc(Nc2noc3...</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>1674894</th>
      <td>296921724</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>NCc1cccs1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(NCc2cccs2)nc(Nc2noc3...</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>1674895</th>
      <td>296921725</td>
      <td>[N-]=[N+]=NCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc...</td>
      <td>Nc1noc2ccc(F)cc12</td>
      <td>NCc1cccs1</td>
      <td>[N-]=[N+]=NCCC[C@H](Nc1nc(NCc2cccs2)nc(Nc2noc3...</td>
      <td>sEH</td>
    </tr>
  </tbody>
</table>
<p>1674896 rows × 6 columns</p>
</div></div></div>
</div>
<p>Podemos observar que este conjunto de datos contiene menos observaciones que <code class="docutils literal notranslate"><span class="pre">train</span></code>, específicamente 1674896 observaciones y 6 columnas.</p>
<p>Comparada con la base de entrenamiento, la de prueba no cuenta con nuestra variable objetivo <code class="docutils literal notranslate"><span class="pre">binds</span></code> por lo que no resultará útil en el modelo.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="ffile.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Punto 1</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="belkasp.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Modelos: NeurIPS 2024 - Predict New Medicines with BELKA</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-la-base-de-datos">Análisis exploratorio de la base de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos-de-entrenamiento">Base de datos de entrenamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtracion-proteina-ephx2-seh">Filtración: proteína EPHX2 - (sEH)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#codificacion-onehotencoder">Codificación: OneHotEncoder</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad-chi-cuadrado">Multicolinealidad: Chi-cuadrado</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtracion-proteina-brd4">Filtración: proteína BRD4</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Codificación: OneHotEncoder</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Multicolinealidad: Chi-cuadrado</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtracion-proteina-hsa">Filtración: proteína HSA</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Codificación: OneHotEncoder</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Multicolinealidad: Chi-cuadrado</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#base-de-datos-de-prueba">Base de datos de prueba</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Valentina Cabrera, Valentina Bustamante
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>